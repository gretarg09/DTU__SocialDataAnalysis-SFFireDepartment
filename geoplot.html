<!DOCTYPE html>

<html lang="en">
    <head>
        <meta charset="utf-8">
        <title>San Francisco fire department</title>
        <script type="text/javascript" src="d3/d3.js"></script>
        <script type="text/javascript" src="d3/d3-tip/index.js"></script>
        <link rel="stylesheet" href="style/myStyle.css">
        <link rel="stylesheet" href="style/normalize.css">
        <link rel="stylesheet" href="style/skeleton.css">
    </head>
    <body>
        <h1 >Fire Department Calls for Service</h1>
        <div class='container'>
            <div class='row'>
                <div class='twelve columns exercise-view'>
                    <h4 >Analyses of the response time of the San Francisco fire department</h4>

                    <div class="visual-container"> 
                        <div class='visual-buttons'> 
                            <a href="index.html"> <button id="page1_btn" class="visual-button banner-btns">Introduction</button></a>
                            <a href="responsetime.html"> <button id="page2_btn" class="visual-button banner-btns">Response time</button></a>
                            <a href="geoplot.html"><button id="page3_btn" class="visual-button page_button_chosen banner-btns">Geo plot</button></a>
                            <a href="machinelearning.html"><button id="page4_btn" class="visual-button banner-btns">Machine learning</button></a>
                        </div>
                    <div id="Visualization1_text">
                </div>
            </div>


            <div class='row'>
                <div class='twelve columns exercise-view'>

                    <h2>Responsive geoplot</h2>

                    <div id="Visualization1_text">
                        <p>Below we visualize the San Francisco are on a responsive geoplot. Relevant </p>
                    </div>

                    <div class='visual-buttons'> 
                            <button id="geo_button1" class="button_geo button_geo1 visual-button">Average response time</button>
                            <button id="geo_button2" class="button_geo button_geo1 visual-button">Average distance to responding fire station</button>
                            <button id="geo_button3" class="button_geo button_geo1 visual-button">Ratio of late response time </button>
                            <button id="geo_button4" class="button_geo button_geo1 visual-button">Ratio of critically late response time </button>
                    </div>
                </div>
            </div>

            <div class='row'>
                <div class='overlapping twelve columns exercise-view'>
                     
                    <div style="text-align:left;">
                        <div>
                            <svg width="40" height="25" > 
                                <rect x="0" y="0" width="20" height="25" fill="rgba(208,85,75,1)" stroke="rgba(128, 128, 128, 1.0)" stroke-width="1"/>
                            </svg>
                             <span class="color-scale-span" id="scale_text1"> Avg. response time <= 8 min </span>
                        </div>

                        <div>
                            <svg width="40" height="25" > 
                                <rect x="0" y="0" width="20" height="25" fill="rgba(226,153,147,1)" stroke="rgba(128, 128, 128, 1)" stroke-width="1"/>
                            </svg>

                             <span class="color-scale-span" id="scale_text2"> 7 min =< Avg. response time < 8 min</span>
                        </div>

                        <div>
                            <svg width="40" height="25" > 
                                <rect x="0" y="0" width="20" height="25" fill="rgba(226,234,154,1)" stroke="rgba(128, 128, 128, 1)" stroke-width="1"/>
                            </svg>

                             <span class="color-scale-span" id="scale_text3"> 6 min =< Avg. response time < 7 min </span>
                        </div>

                        <div >
                            <svg width="40" height="25" > 
                                <rect x="0" y="0" width="20" height="25" fill="rgba(242,246,211,1)" stroke="rgba(128, 128, 128, 1)" stroke-width="1"/>
                            </svg>

                             <span class="color-scale-span" id="scale_text4"> Avg. response time < 6 min </span>
                        </div>
                    </div>

                </div>

                <div class='twelve columns exercise-view'>
                    <div class="visual-container"> 

                        <div id="area1"></div> 

                        <div class='visual-buttons'> 
                            <button id="y2012" class="button_geo button_geo2 visual-button">2012</button>
                            <button id="y2013" class="button_geo button_geo2 visual-button">2013</button>
                            <button id="y2014" class="button_geo button_geo2 visual-button">2014</button>
                            <button id="y2015" class="button_geo button_geo2 visual-button">2015</button>
                            <button id="y2016" class="button_geo button_geo2 visual-button">2016</button>
                            <button id="yoverall" class="button_geo button_geo2 visual-button">All</button>
                        </div>
                        <div class="overlapping2">
                            <span id="h2_neighborhood">Responsive geoplot</span>
                        </div>

                         <div id="area1_histo"></div> 


                        <div id="Visualization1_text" class="geoplot_result_text">
                            <p> Hérna þurfum við að koma með einhverja skemmtilega niðurstöður úr visualizationinu. Túlka hlutina á skemmtilegan máta og koma meðo eitthað skemmtilegt  </p>
                        </div>

                    </div>
                </div>
            </div>
        </div> 

        <script type="text/javascript">
            // GEOPLOT AND HOURLY HISTOGRAM 
            //var primaryColor = "rgba(135,206,235,1)"
            var primaryColor = "rgba(208,85,75,1)";
            var secondaryColor = "rgba(226,153,147,1)";
            var moreinfoTextColor = "rgba(255,255,255)";

            var fire_stations;
            var neighborhoods_statistic;

            var neighborhood_map_data;
            var neighborhood_map_data_overall;

            var neighborhood_late_ratio;
            var neighborhood_verylate_ratio

            var geojson;

            var late_arrivals;

            var geo_button_chosen = "geo_button1";
            var geo_button_year_chosen = "yoverall";

            var neighborhood_chosen_index = 0;

            setcolor_button(geo_button_chosen,1);
            setcolor_button(geo_button_year_chosen,2);

            //var map_color = ["rgba(230,230,230,1)", "rgba(255,69,0, 0.4)", "rgba(255,69,0, 0.6)","rgba(255,69,0,0.8)"]
            //var map_color = ["rgba(230,230,230,1)", "rgba(179,179,179,1)", "rgba(153,153,153,1)","rgba(128,128,128,1)"]

            //Yellow to red map color
            var map_color = ["rgba(242,246,211,1)","rgba(226,234,154,1)", "rgba(226,153,147,1)","rgba(208,85,75,1)"];

            var w = 960,
                h = 600;

            var projection = d3.geo.mercator()
                .center([-122.433701, 37.767683])
                .scale(200000)
                .translate([w / 2, h / 2]);

            var path = d3.geo.path()
                .projection(projection);

            //Define quantize scale to sort data values into buckets of color
            var color = d3.scale.quantize()
                .domain(d3.range(6))
                // dark green, burgendy, dark blue, mustart yellow, dark grey, sky blue
                .range(["#003C00","#800020","#210860","#999900","#666666","#87ceeb"]);

            //Define quantize scale to sort data values into buckets of color for mean value data points
            var mean_color = d3.scale.quantize()
                .domain(d3.range(6))
                // dark green, burgendy, dark blue, mustart yellow, dark grey, sky blue
                .range(["#326232","#99324c","#63528f","#b7b74c","#757575","#abdcf1"]);

            //Create SVG element
            var svg = d3.select("#area1")
                .append("svg")
                .attr("width", w)
                .attr("height", h);

            // Create tip for the neighborhoods in the map
            var tip_neighborhoods = d3.tip()
              .attr('class', 'd3-tip')
              .offset([0,0])
              .html(function(d,i) {
                    if(i == 41){
                        i = neighborhood_chosen_index;
                    }
                    return get_additional_info_for_neighborhood(d,i)
                });


            svg.call(tip_neighborhoods);  

            // Create tip for each station
            var tip_firestations = d3.tip()
              .attr('class', 'd3-tip')
              .offset([-20,0])
              .html(function(d) {
                return "<div style='margin-bottom: 6px'><strong style='margin-right: 6px'>" + "STATION " + d['station'] + "</strong></div>"
                                + "<div style='margin-bottom: 6px'><span class='tipperCol' >" + d['location'] + "</span></div>"
                                + "<div><span class='tipperCol' >" + d['battalion'] + "</span></div>";;
              });
            svg.call(tip_firestations);  

            // create histogram for each hour
            var margin = {top: 40, right: 20, bottom: 50, left: 60},
            width = 960 - margin.left - margin.right,
            height = 250 - margin.top - margin.bottom;

            var xScale = d3.scale.ordinal()
                .domain(["0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23"])
                .rangeRoundBands([0, width], .1);

            var yScale = d3.scale.linear()
                .domain([0, 1000])
                .range([height, 0]);
                
            var xAxis = d3.svg.axis()
                .scale(xScale)
                .orient("bottom");

            var yAxis = d3.svg.axis()
                .scale(yScale)
                .orient("left")
              //.tickFormat(formatPercent);

            var tip = d3.tip()
                .attr('class', 'd3-tip')
                .offset([-20, 0])
                .html(function(d,i) {
                    return "<div style='margin: 0px 0px 15px 0px; text-align:center';><strong style='margin-right: 6px'>" + "Hour: " + i +  "</strong></div>"

                        + "<div style='margin-bottom: 6px '><span class='tipperCol' >" + "Average response time:" + "</span></strong> <span style='color:"+ secondaryColor + "'>"+ minutes_from_seconds(d) + " (" + Math.round(d) + " sek)"+ "</div>";
                })
            
            var svg1_histo = d3.select("#area1_histo")
                .append("svg")
                .attr("width", width + margin.left + margin.right)
                .attr("height", height + margin.top + margin.bottom)
                .append("g")
                .attr("transform", "translate(" + margin.left + "," + margin.top + ")");

            svg1_histo.append("text")
                .attr("text-anchor", "middle")  // this makes it easy to centre the text as the transform is applied to the anchor
                .attr("transform", "translate("+ (width/2) +","+ (height + margin.bottom - 3) +")")  // centre below axis
                .text("Hour of the day");

            svg1_histo.call(tip);

            d3.json("Notebook/Data/response_time_groups_nltfree.json", function(error,json) {
                if (error) {  //If error is not null, something went wrong.
                    console.log(error);  //Log the error.
                } 
                else {  
                    console.log("neighborhood data:");
                    console.log(json);

                    neighborhood_map_data_overall = json;
                    update_data();
                    update_neighborhood(neighborhood_chosen_index);

                    create_hourly_histogram();

                    //Load in GeoJSON data
                    d3.json("Notebook/Data/Analysis Neighborhoods.geojson", function(json){
                        //console.log(json);
                        //Bind data and create one path per GeoJSON feature
                        geojson = json;
                        createSFPDmap(json);

                        d3.json("Notebook/Data/fire_station.json", function(error,json) {
                            if (error) {  //If error is not null, something went wrong.
                                console.log(error);  //Log the error.
                            } 
                            else {  
                                //console.log(json);
                                fire_stations = json;
                                create_FireStation_circles(fire_stations);
                            }   
                        });


                        d3.json("Notebook/Data/neighborhood_statistic.json", function(error,json) {
                            if (error) {  //If error is not null, something went wrong.
                                console.log(error);  //Log the error.
                            } 
                            else {  
                                //console.log(json);
                                neighborhoods_statistic = json;
                            }   
                        });

                        // p button click event handler
                        d3.selectAll("button")
                            .filter(".button_geo1")
                            .on("click", function() {

                                // Set color on kmeans_p
                                var button_ID = d3.select(this).attr("id");
                                geo_button_chosen = button_ID
                                console.log(button_ID);

                                setcolor_button(button_ID,1);

                                update_geo_when_clicked();
                                update_scale_txt();
                            });

                        d3.selectAll("button")
                            .filter(".button_geo2")
                            .on("click", function() {

                                // Set color on kmeans_p
                                var button_ID = d3.select(this).attr("id");
                                geo_button_year_chosen = button_ID;
                                setcolor_button(button_ID,2);

                                update_data();
                                update_geo_when_clicked();
                                update_scale_txt();
                                update_hourly_histogram();

                                //update_geo();
                                //update_scale_txt();
                            });

                    });
                }   
            });
            // The function returns longitute latitute value pairs
            function get_lonlat_pair(d,i){
                var lat = d["lat"];
                var lon = d["lon"];
                
                return [lon,lat];
            }

            // Create the SFPD map from geojson data
            function createSFPDmap(json_data) {
                //Load in GeoJSON data
                //Bind data and create one path per GeoJSON feature
                //console.log(json_data);
                console.log(json_data);
                svg.selectAll("path")
                    .data(json_data.features)
                    .enter()
                    .append("path")
                    .attr("d", path)
                    .on('mouseover', tip_neighborhoods.show)
                    .on("click", function(d,i){
                        update_neighborhood(i);
                        update_hourly_histogram();
                        update_geo_when_clicked();
                    })
                    .on('mouseout', tip_neighborhoods.hide)
                    .attr('stroke-width',1)
                    .attr('stroke',function(d,i){
                        return "#626262";
                    })
                    .attr('fill', function(d,i){
                        return getColor_district(i);
                    })
                    .attr('class','mapDistrict');
            }

            // updating geoplot based on what button is chosen
            function update_geo(){
                var paths =  svg.selectAll("Path")
                paths.attr('fill', function(d,i){
                        return getColor_district(i);
                    })
            }

            function remove_geo_graph()
            {
                // First we delete all paths and then we recreate the paths 
                var paths = svg.selectAll("path")
                    .data([]);  

                paths.exit()
                    .remove();
            }

            function update_geo_when_clicked(){
                console.log("running inside update geo when clicked");

                 remove_geo_graph();
                // Because we want to color the outline of one neighborhood in front of the others we add another feature
                // to the geojson data. We then need to recolor the firestations onto the map.

                console.log("neighborhood chosen");
                console.log(neighborhood_chosen_index);

                if(geojson.features.length > 41){
                    geojson.features.pop();
                }

                var feature = geojson.features[neighborhood_chosen_index];
                geojson.features.push(feature);   
                console.log(geojson);

                svg.selectAll("path")
                    .data(geojson.features)
                    .enter()
                    .append("path")
                    .attr("d", path)
                    .on('mouseover', tip_neighborhoods.show)
                    .on("click", function(d,i){
                        if(i == 41){
                            update_neighborhood(neighborhood_chosen_index);
                        }
                        else{
                            update_neighborhood(i);
                        }
                        update_geo_when_clicked();
                        update_hourly_histogram();
                        //update_geo();
                    })
                    .on('mouseout', tip_neighborhoods.hide)
                    .attr('stroke-width', function(d,i){
                        if(i == 41){
                            return 1;
                        }
                        else {
                            return 0.6;
                        }
                    })
                    .attr('stroke',function(d,i){
                        if(i == 41){
                            console.log("running inside 41");
                            //return primaryColor;
                            return "#000000";
                        }
                        else {
                            return "#626262";
                        }
                    })
                    .attr('fill', function(d,i){
                        if(i == 41){
                            return getColor_district(neighborhood_chosen_index);
                        }
                        else{
                            return getColor_district(i);
                        }
                    })
                    .attr('class','mapDistrict');

                //We need to delete the firestatio circles and the corresponding text and creating them again.
                delete_FireStation_circles();
                create_FireStation_circles(fire_stations);
            }

            // Delete fire station circles
            function delete_FireStation_circles()
            {
                var circle = svg.selectAll("circle")
                    .data([]);   

                var text = svg.selectAll("text")
                    .data([]);

                circle.exit()
                    .remove();

                text.exit()
                    .remove();
            }


            // create the fire station circles
            function create_FireStation_circles(fire_stations_data) {
                    //Create circles for each observation
                    var circle_radius = 6;

                    svg.selectAll("circle")
                        .data(fire_stations_data)
                        .enter()
                        .append("circle")
                        .attr("cx", function(d,i) { return projection(get_lonlat_pair(d,i))[0];})
                        .attr("cy", function(d,i) { return projection(get_lonlat_pair(d,i))[1];})
                        .attr("r",function(d){ return circle_radius;})
                        .on('mouseover', tip_firestations.show)
                        .on('mouseout', tip_firestations.hide)
                        .attr("class","fire_station_circles");


                    svg.selectAll("text")
                        .data(fire_stations_data)
                        .enter()
                        .append("text")
                        .attr("class","labels")
                        .text(function(d) {
                            return d["station"];
                        })
                        .attr("x", function(d,i) {
                            var bbox = this.getBBox();
                            var thisWidth = bbox.width;
                            return projection(get_lonlat_pair(d,i))[0] - thisWidth/3;
                        })
                        .attr("y", function(d,i) {
                            var bbox = this.getBBox();
                            var thisHeight = bbox.height;
                            return projection(get_lonlat_pair(d,i))[1] - circle_radius - 2.5;
                        })
                        .attr("font-family", "sans-serif")
                        .attr("font-size", "10px")
                        .attr("fill", "#8b0000");

            }

            // Create the hourly Histagram for the neighborhoods
            function create_hourly_histogram()
            {
                svg1_histo.append("g")
                    .attr("class", "x axis")
                    .attr("transform", "translate(0," + height + ")")
                    .call(xAxis)
                    .selectAll("text");

                svg1_histo.append("g")
                    .attr("class", "y axis")
                    .call(yAxis)
                    .append("text")
                    .attr("transform", "rotate(-90)")
                    .attr("y", 6)
                    .attr("dy", ".71em")
                    .style("text-anchor", "end")
                    .text("time (sek)");

                svg1_histo.selectAll(".bar")
                    .data(neighborhood_map_data[neighborhood_chosen_index]["response"]["hourly"])
                    .enter()
                    .append("rect")
                    .attr("class", "bar")
                    .attr("x", function(d,i) { return xScale(i); })
                    .attr("width", xScale.rangeBand())
                    .attr("y", function(d) { return yScale(d); })
                    .attr("height", function(d) { return height - yScale(d); })
                    .on('mouseover', tip.show)
                    .on('mouseout', tip.hide);
            }

            // Update the hourly Histogram with information about a specific neighborhood
            function update_hourly_histogram()
            {
                //Update all rects
                var bar = svg1_histo.selectAll("rect")
                    .data(neighborhood_map_data[neighborhood_chosen_index]["response"]["hourly"])

                bar.transition()
                    .duration(500)
                    .attr("x", function(d,i) { return xScale(i); })
                    .attr("width", xScale.rangeBand())
                    .attr("y", function(d) { return yScale(d); })
                    .attr("height", function(d) { return height - yScale(d); })
            }


            function update_data(){
                console.log(geo_button_year_chosen);
                var key = "combined" +  filter_yearbutton_id(geo_button_year_chosen);
                console.log(key);
                neighborhood_map_data = neighborhood_map_data_overall[key];
                console.log("neighborhood map data chosen");
                console.log(neighborhood_map_data);
            }

            function update_neighborhood(index){
                neighborhood_chosen_index = index;
                document.getElementById('h2_neighborhood').innerHTML = neighborhood_map_data[neighborhood_chosen_index]["hood"];
            }

            // Get color for an district based on corresponding average respond time
            function getColor_district(index){
                if(geo_button_chosen == "geo_button1"){
                    console.log(index);
                    var respondtime = Math.round(neighborhood_map_data[index]["response"]["avg"]);
                    if(respondtime >= 480){
                        return map_color[3];
                    }
                    else if (respondtime >= 420 && respondtime < 480){
                        return map_color[2];
                    }
                    else if (respondtime >= 360 && respondtime < 420){
                        return map_color[1];
                    }
                    else {
                        return map_color[0];
                    }
                }
                else if (geo_button_chosen == "geo_button2"){
                    var avg_distance = neighborhood_map_data[index]["distance"]["avg"]*1000;
                    //console.log(avg_distance);
                    if(avg_distance >= 1500){
                        return map_color[3];
                    }
                    else if (avg_distance >= 1000 && avg_distance < 1500){
                        return map_color[2];
                    }
                    else if (avg_distance >= 500 && avg_distance < 1000){
                        return map_color[1];
                    }
                    else {
                        return map_color[0];
                    }
                }
                else if (geo_button_chosen == "geo_button3"){
                    var late_ratio = neighborhood_map_data[index]["late-ratio"];

                    if(late_ratio >= 0.3){
                        return map_color[3];
                    }
                    else if (late_ratio >= 0.25 && late_ratio < 0.3){
                        return map_color[2];
                    }
                    else if (late_ratio >= 0.2 && late_ratio < 0.25){
                        return map_color[1];
                    }
                    else {
                        return map_color[0];
                    }
                }
                else if (geo_button_chosen == "geo_button4"){
                    var verylate_ratio = neighborhood_map_data[index]["verylate-ratio"];

                    if(verylate_ratio >= 0.1){
                        return map_color[3];
                    }
                    else if (verylate_ratio >= 0.075 && verylate_ratio < 0.1){
                        return map_color[2];
                    }
                    else if (verylate_ratio >= 0.05 && verylate_ratio < 0.075){
                        return map_color[1];
                    }
                    else {
                        return map_color[0];
                    }
                }
                else {
                    return map_color[0];
                }

                // over 10 min 10 * 60 = 600 
                // yfir 9 min 9 * 60 = 540
                // yfir 8 min 8 * 60 = 480
                // undir 8 min 7 * 60 = 420
            }

            function update_scale_txt(){
                var text1;
                var text2;
                var text3;
                var text4;

                if(geo_button_chosen == "geo_button1"){
                    text1 = "Avg. response time <= 8 min";
                    text2 = "7 min =< Avg. response time < 8 min";
                    text3 = "6 min =< Avg. response time < 7 min";
                    text4 = "Avg. response time < 6 min";
                }
                else if (geo_button_chosen == "geo_button2"){
                    text1 = "Avg. distance to firestation <= 1500 m";
                    text2 = "1000 m <= Avg. distance to firestation < 1500 m";
                    text3 = "500 m <= Avg. distance to firestation < 1000 m";
                    text4 = "Avg. distance to firestation < 500 m";
                }
                else if (geo_button_chosen == "geo_button3"){
                    text1 = "Ratio of late responses <= 10%";
                    text2 = "7,5% <= Ratio of late responses < 10%";
                    text3 = "5% <= Ratio of late respones < 7,5%";
                    text4 = "Ratio of late responses < 5%";
                }
                else if (geo_button_chosen == "geo_button4"){
                    text1 = "Ratio of critically late responses <= 10%";
                    text2 = "7,5% <= Ratio of critically late responses < 10%";
                    text3 = "5% <= Ratio of critically late respones < 7,5%";
                    text4 = "Ratio of critically late responses < 5%";
                }
                else {
                    text1 = "";
                    text2 = "";
                    text3 = "";
                    text4 = "";
                }

                document.getElementById('scale_text1').innerHTML = text1; 
                document.getElementById('scale_text2').innerHTML = text2; 
                document.getElementById('scale_text3').innerHTML = text3; 
                document.getElementById('scale_text4').innerHTML = text4; 
            }

            // sort an array by dictionary key
            function sortByKey(array, key) {
                return array.sort(function(a, b) {
                    var x = a[key];
                    var y = b[key];

                    if (typeof x == "string"){
                        x = x.toLowerCase(); 
                    }
                    if (typeof y == "string"){
                        y = y.toLowerCase();
                    }

                    return ((x < y) ? -1 : ((x > y) ? 1 : 0));
                });
            }

            // Change seconds to minutes and seconds
            function minutes_from_seconds(time){
                time = Math.round(time);
                var minutes = Math.floor(time / 60);
                var seconds = Math.round(time - minutes * 60);

                return minutes + " min " + seconds + " seconds";
            }

            function getPercentage(n){
                return Math.round(n * 100 * 100)/100;
            }

            function getMetersFromKm(n){
                return Math.round(n * 1000);
            }

            // returns addition info for the neighborhood district
            function get_additional_info_for_neighborhood(d,i){
                var additional_info_html = "<div style='margin: 0px 0px 15px 0px; text-align:center';><strong style='margin-right: 6px'>" + neighborhoods_statistic[i]['neighborhood'] + "</strong></div>"

                        + "<div style='margin-bottom: 6px '><span class='tipperCol' >" + "Average response time:" + "</span></strong> <span style='color:"+ secondaryColor + "'>" + minutes_from_seconds(neighborhood_map_data[i]["response"]["avg"]) + "</div>"

                        + "<div style='margin-bottom: 6px '><span class='tipperCol' >" + "Average distance to responding fire station:" + "</span></strong> <span style='color:"+ secondaryColor + "'>" + getMetersFromKm(neighborhood_map_data[i]["distance"]["avg"]) + " meters" +"</div>"

                        + "<div style='margin-bottom: 6px '><span class='tipperCol' >" + "Ratio of late response time:" + "</span></strong> <span style='color:"+ secondaryColor + "'>"  + getPercentage(neighborhood_map_data[i]["late-ratio"]) + "%" + "</div>"

                        + "<div style='margin-bottom: 15px '><span class='tipperCol' >" + "Ratio of critically late response time:" + "</span></strong> <span style='color:"+ secondaryColor + "'>"  + getPercentage(neighborhood_map_data[i]["verylate-ratio"]) + "%" + "</div>"

                        + "<div style='margin-bottom: 10px'><strong style='margin-right: 6px'>" + "Additional info:" + "</strong></div>";


                    if(neighborhoods_statistic[i]['neighborhood'] == "Lincoln Park" || neighborhoods_statistic[i]['neighborhood'] == "McLaren Park"){
                        return additional_info_html + "<div style='margin-bottom: 6px'><span class='tipperCol' >" + "This is just a park so there is no additional info to see here" + "</span></strong> </div>";
                    }
                    else {
                        return additional_info_html
                        
                        + "<div style='margin-bottom: 6px'><span class='tipperCol' >" + "Population:" + "</span></strong> <span style='color:rgba(135,206,235,1)'>" + neighborhoods_statistic[i]['total_population'] + " inhabitants" + "</span>  </div>"

                        + "<div style='margin-bottom: 6px'><span class='tipperCol' >" + "Population density:" + "</span></strong> <span style='color:rgba(135,206,235,1)'>" + neighborhoods_statistic[i]['people_density'] + " per square mile"  + "</span>  </div>"

                        + "<div style='margin-bottom: 6px'><span class='tipperCol' >" + "Area:" + "</span></strong> <span style='color:rgba(135,206,235,1)'>" + neighborhoods_statistic[i]['area'] + " square miles" + "</span>  </div>"

                        + "<div style='margin-bottom: 6px'><span class='tipperCol' >" + "Median household income:" + "</span></strong> <span style='color:rgba(135,206,235,1)'>" + "$ "+ neighborhoods_statistic[i]['household_income'] + "</span> <span class='tipperCol' >" + "</span>   </div>";
                    }
            }

            // Sets the text color of each p as black except the chosen model
            function setcolor_button(chosen_button, button_cluster) {
                button_cluster = ".button_geo" + button_cluster;
                //console.log(button_cluster);

                d3.selectAll("button")
                    .filter(button_cluster)
                    .style("color", "black");

                d3.selectAll("button")
                    .filter("#"+chosen_button)
                    .style("color", primaryColor);
            }

            function filter_yearbutton_id(id){
                console.log(id);
                if(id == "y2012"){
                    return "2012";
                }
                if(id == "y2013"){
                    return "2013";
                }
                if(id == "y2014"){
                    return "2014";
                }
                if(id == "y2015"){
                    return "2015";
                }
                if(id == "y2016"){
                    return "2016";
                }
                else{
                    return "overall"
                }
            }
            
        </script>

    </body>
</html>